"use strict";angular.module("cellBoardApp",[]),function(){var a=function(a,b,c,d,e){a.cellBoardList=null,a.selectedCellBoard=null,a.init=function(){a.cellBoardList=[angular.copy(b),angular.copy(c),angular.copy(d),angular.copy(e)];for(var f=0;4>f;f++)a.cellBoardList[f].rowsTemplate=angular.copy(a.cellBoardList[f].rows);a.selectedCellBoard=a.cellBoardList[0]},a.init(),a.changeColor=function(){var b=a.selectedCellBoard,c="lightgreen";switch(b.selectedCell.color){case"lightgreen":c="yellow";break;case"yellow":c="red";break;case"red":c="gray";break;case"gray":c="lightgreen"}b.selectedCell.color=c};var f=function(a,b){for(var c=0;c<a.cells.length;c++){var d=a.cells[c];if(d.cells){var e=f(d,b);if(e)return e}else if(d.id===b)return d}return null},g=function(a,b){for(var c=0;c<a.length;c++){var d=f(a[c],b);if(d)return c}return-1};a.deleteRow=function(){var b=a.selectedCellBoard,c=g(b.rows,b.selectedCell.id);b.selectedCell=null,b.rows.splice(c,1)},a.getNewRowCode=function(a){var b=(a.rows.length+65)%128,c=Math.floor((a.rows.length+65)/128);c=0===c?"":String.fromCharCode(c+64);for(var d="",e=0;100>e&&(d=c+String.fromCharCode(b+e),-1!==g(a.rows,d+"1"));e++);return d},a.addRowByTemplate=function(b,c){for(var d=angular.copy(c),e=a.getNewRowCode(b),f=0;f<d.cells.length;f++){var g=d.cells[f];if(g.id=e+(f+1),g.cells)for(var h=0;h<g.cells.length;h++)g.cells[h].id=g.id+(h+1)}b.rows.push(d)},a.addRows=function(){for(var b=a.selectedCellBoard,c=b.rowsTemplate,d=0;d<c.length;d++)a.addRowByTemplate(b,c[d])},a.duplicateRow=function(){var b=a.selectedCellBoard,c=g(b.rows,b.selectedCell.id);a.addRowByTemplate(b,b.rows[c])}};a.$inject=["$scope","testBoard1","testBoard2","testBoard3","testBoard4"];var b=angular.module("cellBoardApp");b.controller("mainController",a)}(),function(){var a=["$scope",function(a){a.totalWidth=0,a.totalHeight=0,a.totalRowWidth=0,a.totalRowHeights=[],a.scaleHorizontal=1,a.scaleVertical=1,a.getBgColor=function(a){return a.color},a.getWidth=function(b){return parseInt(b.width)*a.scaleHorizontal+"px"},a.getHeight=function(b){return parseInt(b.height)*a.scaleVertical+"px"},a.isSelectedCell=function(b){return a.ngModel.selectedCell===b},a.setSelectedCell=function(b,c){a.ngModel.selectedCell=b,null==b};var b=function(a){return a.reduce(function(a,b){return a+b},0)};a.calculateTotalWidth=function(){return Math.max.apply(Math,a.ngModel.rows.map(function(a){var c=a.cells.map(function(a){return a.width?parseInt(a.width):a.cells?Math.max.apply(Math,a.cells.map(function(a){return parseInt(a.width)})):0});return b(c)}))},a.calculateTotalHeight=function(){return a.totalRowHeights=a.ngModel.rows.map(function(a){return Math.max.apply(Math,a.cells.map(function(a){if(a.height)return parseInt(a.height);if(a.cells){var c=a.cells.map(function(a){return parseInt(a.height)});return b(c)}}))}),b(a.totalRowHeights)},a.getTotalRowHeight=function(b){return a.totalRowHeights[b]*a.scaleVertical+"px"},a.resize=function(){var b=a.calculateTotalWidth();a.totalRowWidth=b*a.scaleHorizontal+"px",a.totalWidth=b*a.scaleHorizontal+1+"px",a.totalHeight=a.calculateTotalHeight()*a.scaleVertical+1+"px"},a.init=function(){a.scaleHorizontal=a.scaleHorizontal||1,a.scaleVertical=a.scaleVertical||1,a.$watch("ngModel.rows.length",a.resize)}}],b=function(b){return{restrict:"E",scope:{ngModel:"=",scaleHorizontal:"@",scaleVertical:"@"},templateUrl:"views/cellBoardTmpl.html",replace:!0,require:"ngModel",link:function(a,b,c){a.scaleHorizontal=a.$eval(c.scaleHorizontal),a.scaleVertical=a.$eval(c.scaleVertical),a.init()},controller:a}};b.$inject=["$document"];var c=angular.module("cellBoardApp");c.directive("cellBoard",b)}(),function(){var a={id:1,name:"Flexible",selectedCell:null,rows:[{cells:[{id:"A1",width:8,height:2,color:"gray"}]},{cells:[{id:"B1",width:2,height:1,color:"red"},{id:"B2",width:2,height:1,color:"yellow"},{id:"B3",width:2,height:1,color:"lightgreen"},{id:"B4",width:2,height:1,color:"lightgreen"}]},{cells:[{id:"C1",width:2,height:1,color:"lightgreen"},{id:"C2",width:2,height:1,color:"lightgreen"},{id:"C3",width:2,height:1,color:"lightgreen"},{id:"C4",width:2,height:1,color:"lightgreen"}]},{cells:[{id:"D1",width:5,height:2,color:"lightgreen"},{id:"D2",width:3,height:2,color:"yellow"}]},{cells:[{id:"E1",width:3,height:2,color:"lightgreen"},{id:"E2POD",width:5,height:2,color:"lightgreen",cells:[{id:"E21",width:5,height:1,color:"lightgreen"},{id:"E22",width:5,height:1,color:"lightgreen"}]}]},{cells:[{id:"F1",width:2,height:3,color:"lightgreen"},{id:"F2",width:2,height:3,color:"lightgreen"},{id:"F3",width:2,height:3,color:"lightgreen"},{id:"F4",width:2,height:3,color:"lightgreen"}]},{cells:[{id:"G1",width:2,height:1,color:"lightgreen"},{id:"G2",width:2,height:1,color:"lightgreen"},{id:"G3",width:2,height:1,color:"lightgreen"},{id:"G4",width:2,height:1,color:"lightgreen"}]},{cells:[{id:"H1",width:2,height:2,color:"lightgreen"},{id:"H2",width:2,height:2,color:"lightgreen"},{id:"H3",width:2,height:2,color:"lightgreen"},{id:"H4",width:2,height:2,color:"lightgreen"}]},{cells:[{id:"I1",width:2,height:1,color:"lightgreen"},{id:"I2",width:2,height:1,color:"lightgreen"},{id:"I3",width:2,height:1,color:"lightgreen"},{id:"I4",width:2,height:1,color:"lightgreen"}]}]},b=angular.module("cellBoardApp");b.value("testBoard1",a)}(),function(){var a={id:2,name:"Helix",selectedCell:null,rows:[{cells:[{id:"A1",width:4,height:5,color:"lightgreen"},{id:"A2",cells:[{id:"A21",width:4,height:1,color:"lightgreen"},{id:"A22",width:4,height:1,color:"yellow"},{id:"A23",width:4,height:1,color:"lightgreen"},{id:"A24",width:4,height:1,color:"lightgreen"},{id:"A25",width:4,height:1,color:"lightgreen"}]}]},{cells:[{id:"B1",width:8,height:4,color:"lightgreen"}]},{cells:[{id:"C1",width:2,height:2,color:"lightgreen"},{id:"C2",width:2,height:2,color:"lightgreen"},{id:"C3",width:2,height:2,color:"lightgreen"},{id:"C4",width:2,height:2,color:"lightgreen"}]},{cells:[{id:"D1",width:1,height:5,color:"red"},{id:"D2",width:7,height:5,color:"lightgreen"}]},{cells:[{id:"E1",width:3,height:4,color:"lightgreen"},{cells:[{id:"E21",width:1,height:2,color:"lightgreen"},{id:"E22",width:1,height:2,color:"lightgreen"}]},{cells:[{id:"E31",width:1,height:2,color:"lightgreen"},{id:"E32",width:1,height:2,color:"lightgreen"}]},{cells:[{id:"E41",width:1,height:2,color:"lightgreen"}]},{cells:[{id:"E51",width:1,height:2,color:"lightgreen"}]}]}]},b=angular.module("cellBoardApp");b.value("testBoard2",a)}(),function(){var a="lightgreen",b=function(b,c,d,e){b.push({id:c,width:d,height:e,color:a})},c=function(a,c,d,e){for(var f={cells:[]},g=0;c>g;g++)b(f.cells,a+(g+1),d,e);return f},d=function(a){return c(a,9,1,1)},e=function(a){return c(a,3,3,2)},f=function(a){return c(a,3,3,1)},g=function(a){for(var c={cells:[]},d=0;4>d;d++)b(c.cells,a+(d+1),2,2);for(var e={cells:[]},f=0;2>f;f++)b(e.cells,a+(d+f+1),1,1);return c.cells.push(e),c},h=function(a){for(var c={cells:[]},d=0;3>d;d++)b(c.cells,a+(d+1),2,1);for(var d=3;6>d;d++)b(c.cells,a+(d+1),1,1);return c},i={id:3,name:"Modulo DCS",selectedCell:null,rows:[]},j=function(a,b){for(var c=0;c<a.cells.length;c++){var d=a.cells[c];if(d.cells){var e=j(d,b);if(e)return e}else if(d.id===b)return d}return null},k=function(a,b){for(var c=0;c<a.length;c++){var d=j(a[c],b);if(d)return d}return null},l=(function(){for(var a=65,b=0;4>b;b++)i.rows.push(d(String.fromCharCode(b+a)));for(var b=4;6>b;b++)i.rows.push(e(String.fromCharCode(b+a)));for(var b=6;10>b;b++)i.rows.push(f(String.fromCharCode(b+a)));for(var b=10;12>b;b++)i.rows.push(g(String.fromCharCode(b+a)));for(var b=12;16>b;b++)i.rows.push(h(String.fromCharCode(b+a)));k(i.rows,"C8").color="red",k(i.rows,"K6").color="yellow",k(i.rows,"E1").color="gray"}(),angular.module("cellBoardApp"));l.value("testBoard3",i)}(),function(){var a="lightgreen",b=function(b,c,d,e){b.push({id:c,width:d,height:e,color:a})},c=function(a,c,d,e){for(var f={cells:[]},g=0;c>g;g++)b(f.cells,a+(g+1),d,e);return f},d=function(a){return c(a,9,1,1)},e=function(a){return c(a,3,3,2)},f=function(a){for(var c={cells:[]},d=0;4>d;d++)b(c.cells,a+(d+1),2,2);for(var e={cells:[]},f=0;2>f;f++)b(e.cells,a+(d+f+1),1,1);return c.cells.push(e),c},g=function(a){for(var c={cells:[]},d=0;3>d;d++)b(c.cells,a+(d+1),2,1);for(var d=3;6>d;d++)b(c.cells,a+(d+1),1,1);return c},h=function(a){for(var c={cells:[]},d=0;4>d;d++)b(c.cells,a+(d+1),2,1);for(var d=4;5>d;d++)b(c.cells,a+(d+1),1,1);return c},i={id:4,name:"Modulo XL",selectedCell:null,rows:[]},j=function(a,b){for(var c=0;c<a.cells.length;c++){var d=a.cells[c];if(d.cells){var e=j(d,b);if(e)return e}else if(d.id===b)return d}return null},k=function(a,b){for(var c=0;c<a.length;c++){var d=j(a[c],b);if(d)return d}return null},l=(function(){for(var a=65,b=0;2>b;b++)i.rows.push(e(String.fromCharCode(b+a)));for(var b=2;6>b;b++)i.rows.push(g(String.fromCharCode(b+a)));for(var b=6;10>b;b++)i.rows.push(h(String.fromCharCode(b+a)));for(var b=10;12>b;b++)i.rows.push(f(String.fromCharCode(b+a)));for(var b=12;16>b;b++)i.rows.push(d(String.fromCharCode(b+a)));k(i.rows,"D1").color="red",k(i.rows,"F6").color="yellow";for(var b=12;16>b;b++)for(var c=4;10>c;c++){var j=String.fromCharCode(b+a)+c,l=k(i.rows,j);l&&(l.color="gray")}}(),angular.module("cellBoardApp"));l.value("testBoard4",i)}(),angular.module("cellBoardApp").run(["$templateCache",function(a){a.put("views/cellBoardTmpl.html",'<div class="cell-board-container"> <div class="cell-board-content" ng-style="{ \'width\': totalWidth, \'height\': totalHeight}" ng-cloak> <div ng-repeat="row in ngModel.rows" ng-style="{\'width\': totalRowWidth, \'height\': getTotalRowHeight($index)}"> <ul class="cell-board-row-ul"> <li class="cell-board-noselect cell-board-row-li" ng-repeat="cell in row.cells" ng-style="(cell.cells || isSelectedCell(cell)) ? {} : {\r\n                        \'background-color\': getBgColor(cell)\r\n                    }"> <div class="cell-area" ng-if="!cell.cells" ng-style="{\r\n                            \'width\' : getWidth(cell),\r\n                            \'height\' : getHeight(cell)\r\n                         }" ng-class="{\'cell-area-selected\' : isSelectedCell(cell)}" ng-click="setSelectedCell(cell, $event)"> <div class="cell-content" tooltip="ok"> {{cell.id}} </div> </div> <div ng-if="cell.cells"> <ul class="cell-board-col-ul"> <li class="cell-board-noselect cell-board-col-li" ng-repeat="subcell in cell.cells" ng-style="isSelectedCell(subcell) ? {} : {\r\n                                    \'background-color\': getBgColor(subcell)\r\n                                }"> <div class="cell-area" ng-style="{\r\n                                        \'width\' : getWidth(subcell),\r\n                                        \'height\' : getHeight(subcell)\r\n                                    }" ng-class="{\'cell-area-selected\' : isSelectedCell(subcell)}" ng-click="setSelectedCell(subcell, $event)"> <div class="cell-content"> {{subcell.id}} </div> </div> </li> </ul> </div> </li> </ul> </div> </div> </div>'),a.put("views/main.html",'<div style="margin-bottom:15px"> <label>Selected Board:&nbsp;</label> <select ng-options="cellBoard.name for cellBoard in cellBoardList" ng-model="selectedCellBoard"></select> </div> <div style="margin-bottom:15px"> <cell-board ng-model="selectedCellBoard" scale-vertical="20" scale-horizontal="60"> </cell-board> </div> <div style="margin-bottom:15px"> <button class="btn btn-success" ng-click="addRows()"> Add Rows </button> <button class="btn btn-warning" ng-disabled="!selectedCellBoard.selectedCell" ng-click="changeColor()"> Change Cell Color </button> <button class="btn btn-danger" ng-disabled="!selectedCellBoard.selectedCell" ng-click="deleteRow()"> Delete Row </button> <button class="btn btn-primary" ng-disabled="!selectedCellBoard.selectedCell" ng-click="duplicateRow()"> Duplicate Row </button> </div> <div class="well well-lg"> <div ng-show="selectedCellBoard.selectedCell" style="padding:15px" ng-style="{\'background-color\' : selectedCellBoard.selectedCell.color}"> <div> Selected Cell: <br> {{selectedCellBoard.selectedCell.id}} : {{selectedCellBoard.selectedCell.color}}  </div> <div ng-show="!selectedCellBoard.selectedCell"> <h1>No selection</h1> </div> </div></div>')}]);